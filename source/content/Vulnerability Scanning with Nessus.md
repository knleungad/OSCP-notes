## Start service
`sudo systemctl start nessusd.service`
Then launch browser and navigate to https://127.0.0.1:8834.

## Nessus components

### Templates
under Scans -> Policies -> Scan Templates

General vulnerability scanning templates:
1. *Basic Network Scan*: Full scan with majority of settings predefined (recommended by Nessus). Can be customised.
2. *Advanced Scan*: Template without any predefined settings, used when we want to fully customise our scan or if we have specific needs.
3. *Advanced Dynamic Scan*: Like *Advanced Scan*, but don't need to select plugins manually. The template allows us to configure a *dynamic plugin filter* instead.

## Performing a basic vulnerability scan

Basic Network Scan
1. *Scans* -> *New Scan*
2. *Basic Network Scan*
3. Configure settings:
	1. *Basic* -> *General*
		1. Name
		2. Targets (can be a single IP address, an IP range, a comma-delimited Fully-Qualified Domain Name (FQDN), or an IP address list)
	2. Other settings may be configured as necessary (e.g. port scan range)
	3. Note that UDP port scanning needs to be manually enabled
	4. Configure *Credentials* to perform authenticated scan (otherwise the scan is unauthenticated)
4. Arrow next to *Save* -> *Launch*
5. Scan can be seen under My Scans

## Analysing the results

Useful vulnerability scan report pages:
- *Hosts*
- *VPR Top Threats*: Lists top ten vulnerabilities in the scan according to the Vulnerability Priority Rating (VPR)
- *Remediations*
- *History*: Lists all vulnerability scans with this configuration for comparison with previous scans

*Report* to create and export a report

Note: Check the plugin output for found vulnerabilities. If it was found using the reported version number of the affected application only, we should verify the results to see if the vulnerability is indeed exploitable.

## Performing an authenticated vulnerability scan

Note: If there is an AV on the target machine, we can add an exception for the scan.

Note: User Account Control (UAC) in Windows should be configured to allow Nessus, or should be temporarily disabled. Consult the [Tenable Documentation](https://docs.tenable.com/nessus/Content/CredentialedChecksOnWindows.htm) before beginning scan.

Credentialed Patch Audit Scan 
	(All Nessus templates accept user credentials, but this one comes preconfigured to execute local security checks and will not perform external vulnerability checks. Good for privilege escalation vulnerability detection.)
1. *Scans* -> *New Scan*
2. *Credentialed Patch Audit Scan* 
3. Configure Name and Target
4. Under *Credentials*, select category  (e.g. *Host*) and authentication method (e.g. *SSH*)
	1. Usually, *SSH* is used for Linux and Mac targets, while *Server Message Block (SMB)* and *Windows Management Instrumentation (WMI)* are used for Windows (though *SSH* can also be used). Both methods allow the use of local or domain accounts.
5. Fill in details for the chosen authentication method
6. Arrow next to *Save* -> *Launch*

## Working with Nessus plugins

Advanced Dynamic Scan
	(Allows us to use a dynamic plugin filter instead of manually enabling or disabling plugins.)
1. *Scans* -> *New Scan*
2. *Advanced Dynamic Scan*
3. Configure Name and Target
4. Configure Credentials if necessary
5. Configure *Dynamic Plugins*
	1. Enter filter (e.g. "CVE is equal to CVE-2021-3156")
	2. *Preview Plugins*
	3. Select an option under *Select a Family*
6. Arrow next to *Save* -> *Launch*

