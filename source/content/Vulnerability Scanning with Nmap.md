---
tags: Nmap
---
Purpose: To verify findings from other tools or perform lightweight vulnerability scanning when a full-fledged vulnerability scanner is unavailable.

Note: Verify that the script is safe before use, as some scripts may contain malicious code that gives an attacker full access to our system.

## Using [NSE](https://nmap.org/book/man-nse.html) vulnerability scripts

Relevant NSE script categories (can have multiple):
- *safe* and *vuln*: script has no impact to stability
- *intrusive* and *vuln*: script may crash target service or system

Determine script category [here](https://nmap.org/nsedoc/) or locally in the NSE scripts directory `/usr/share/nmap/scripts/script.db`.

Use Nmap `--script` parameter to specify script(s) to run. Possible arguments:
- A category
- A Boolean expression
- A comma-separated list of categories
- The full or wildcard-specified name of a NSE script in script.db
- An absolute path to a specific script.

E.g. `sudo nmap -sV -p 443 --script "vuln" 192.168.50.124`: specifies all scripts in the *vuln* category

Useful script: `vulners.nse` (use with `-sV`)
- Uses information from detected service and version to provide related vulnerability data
- Shows information about the CVEs found, CVSS scores and links, as well as PoCs (marked with "\*EXPLOIT*")
- Note: A successful service detection is required for this script

## Searching for an NSE script for a particular CVE

1. Using a search engine, search for the CVE number plus "NSE" (e.g. "CVE-2021-41773 nse")
2. Download script and save to `/usr/share/nmap/scripts/` (e.g. `/usr/share/nmap/scripts/http-vuln-cve2021-41773.nse`), complying with the naming syntax of other NSE scripts.
3. `sudo nmap --script-updatedb` to update script.db.
4. `sudo nmap -sV -p 443 --script "http-vuln-cve2021-41773" 192.168.50.124` to use the script (note that service detection is enabled and port number is specified)





